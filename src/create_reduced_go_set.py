import pickle
import re


'''
The script used to generate the reduced protein data set
by removing degenerate GO terms in the DAG.
'''

path_dict = {'BP': [], 'CC': [], 'MF': []}

with open('BPPaths.txt', 'r') as f:
    lines = f.readlines()

    # Remove junk
    path_array = map(lambda x: re.sub(r'\r\n', '', x), lines)
    path_array = map(lambda x: re.sub(r':', '', x), lines)
    path_array = list(map(lambda x: x.split(',')[:-1], path_array))

    path_dict['biological_process'] = path_array
    bp_max_depth = max(map(lambda x: len(x), path_array))

with open('CCPaths.txt', 'r') as f:
    lines = f.readlines()

    # Remove junk
    path_array = map(lambda x: re.sub(r'\r\n', '', x), lines)
    path_array = map(lambda x: re.sub(r':', '', x), lines)
    path_array = list(map(lambda x: x.split(',')[:-1], path_array))

    path_dict['cellular_component'] = path_array
    cc_max_depth = max(map(lambda x: len(x), path_array))

with open('MFPaths.txt', 'r') as f:
    lines = f.readlines()

    # Remove junk
    path_array = map(lambda x: re.sub(r'\r\n', '', x), lines)
    path_array = map(lambda x: re.sub(r':', '', x), lines)
    path_array = list(map(lambda x: x.split(',')[:-1], path_array))

    path_dict['molecular_function'] = path_array
    mf_max_depth = max(map(lambda x: len(x), path_array))

mf_go_terms = ['GO0000166', 'GO0003676', 'GO0036094', 'GO0001882', 'GO0001883', 'GO0005509', 'GO0005525', 'GO0017076', 'GO0032549', 'GO0032561', 'GO0035639', 'GO0043169', 'GO0046872', 'GO0097159', 'GO0003824', 'GO0016787', 'GO0003723', 'GO0001071', 'GO0003700', 'GO0003677', 'GO0003682', 'GO0004175', 'GO0008233', 'GO0004721', 'GO0008092', 'GO0016788', 'GO0016791', 'GO0042578', 'GO0050839', 'GO0003735', 'GO0005198', 'GO0005215', 'GO0003924', 'GO0016462', 'GO0016817', 'GO0016818', 'GO0017111', 'GO0005543', 'GO0008289', 'GO0005506', 'GO0016491', 'GO0016705', 'GO0020037', 'GO0046914', 'GO0016301', 'GO0016740', 'GO0016772', 'GO0016773', 'GO0004672', 'GO0005524', 'GO0030554', 'GO0008270', 'GO0008237', 'GO0048037', 'GO0050662', 'GO0003779', 'GO0005102', 'GO0046982', 'GO0005216', 'GO0005261', 'GO0008324', 'GO0015075', 'GO0015267', 'GO0022857', 'GO0022891', 'GO0003774', 'GO0008509', 'GO0008514', 'GO0015077', 'GO0015081', 'GO0015293', 'GO0022890', 'GO0046873', 'GO0004857', 'GO0004866', 'GO0030234', 'GO0030414', 'GO0005244', 'GO0015079', 'GO0022843', 'GO0016757', 'GO0016758', 'GO0030246', 'GO0019787', 'GO0004252', 'GO0008236', 'GO0017171', 'GO0016829', 'GO0000988', 'GO0000989', 'GO0003712', 'GO0003713', 'GO0000975', 'GO0044212', 'GO0015276', 'GO0000981', 'GO0004871', 'GO0004872', 'GO0038023', 'GO0043565', 'GO0004713', 'GO0008017', 'GO0015631', 'GO0032403', 'GO0008234', 'GO0008168', 'GO0004888', 'GO0000287', 'GO0016887', 'GO0042623', 'GO0005085', 'GO0004674', 'GO0004930', 'GO0016779', 'GO0016746', 'GO0043566', 'GO0008047', 'GO0004518', 'GO0003823', 'GO0042277', 'GO0005125', 'GO0005126', 'GO0004984', 'GO0016874', 'GO0035091', 'GO0005516', 'GO0004386', 'GO0016853', 'GO0001664', 'GO0003714', 'GO0008083', 'GO0005083', 'GO0005096', 'GO0030695', 'GO0019904', 'GO0017016', 'GO0031267', 'GO0051020', 'GO0016747', 'GO0005539', 'GO0044822', 'GO0019900', 'GO0019901', 'GO0031625', 'GO0044389', 'GO0000976', 'GO0000977', 'GO0000978', 'GO0000982', 'GO0000987', 'GO0001012', 'GO0001159', 'GO0004842', 'GO0008134', 'GO0001228', 'GO0016810', 'GO0001077', 'GO0005057']
mf_paths = path_dict['molecular_function']

bp_go_terms = ['GO0006810', 'GO0006897', 'GO0007275', 'GO0007399', 'GO0010033', 'GO0016192', 'GO0016197', 'GO0022008', 'GO0030030', 'GO0030154', 'GO0030182', 'GO0031175', 'GO0032386', 'GO0032388', 'GO0032502', 'GO0042592', 'GO0045595', 'GO0045597', 'GO0046907', 'GO0048468', 'GO0048666', 'GO0048699', 'GO0048856', 'GO0048878', 'GO0050896', 'GO0051050', 'GO0051128', 'GO0051641', 'GO0051649', 'GO0051716', 'GO0060341', 'GO0060627', 'GO0070848', 'GO0071310', 'GO0071363', 'GO0006996', 'GO0007600', 'GO0007601', 'GO0050877', 'GO0050953', 'GO0008152', 'GO0006412', 'GO0006414', 'GO0009058', 'GO0009059', 'GO0010467', 'GO0019538', 'GO0034645', 'GO0044237', 'GO0044267', 'GO0006139', 'GO0006351', 'GO0006355', 'GO0006725', 'GO0006807', 'GO0010468', 'GO0016070', 'GO0019222', 'GO0034641', 'GO0046483', 'GO0051171', 'GO0051252', 'GO1903506', 'GO2001141', 'GO0006508', 'GO0006464', 'GO0006470', 'GO0006796', 'GO0016311', 'GO0007017', 'GO0022613', 'GO0034660', 'GO0042254', 'GO0006461', 'GO0022607', 'GO0043623', 'GO0006629', 'GO0002376', 'GO0002429', 'GO0002682', 'GO0002684', 'GO0002764', 'GO0002768', 'GO0007154', 'GO0007165', 'GO0007166', 'GO0023052', 'GO0050776', 'GO0050778', 'GO0055114', 'GO0007186', 'GO0016310', 'GO0006468', 'GO0019725', 'GO0007155', 'GO0098609', 'GO0006950', 'GO0006979', 'GO0006811', 'GO0006812', 'GO0034220', 'GO0055085', 'GO0098655', 'GO0006325', 'GO0006338', 'GO0009790', 'GO0009792', 'GO0009888', 'GO0016568', 'GO0035295', 'GO0043009', 'GO0051276', 'GO0060429', 'GO0009056', 'GO0019439', 'GO0051186', 'GO0006066', 'GO0010817', 'GO0044255', 'GO0044281', 'GO0010941', 'GO0042981', 'GO0006814', 'GO0006820', 'GO0015672', 'GO0015711', 'GO0015849', 'GO0030001', 'GO0035725', 'GO0046942', 'GO0010466', 'GO0010951', 'GO0010955', 'GO0030162', 'GO0031324', 'GO0032268', 'GO0032269', 'GO0043086', 'GO0045861', 'GO0050790', 'GO0051246', 'GO0051248', 'GO0051346', 'GO0052547', 'GO0052548', 'GO0070613', 'GO0006082', 'GO0006520', 'GO0019752', 'GO1901605', 'GO0007167', 'GO0007169', 'GO0009607', 'GO0000226', 'GO0007010', 'GO0007049', 'GO0022402', 'GO0006813', 'GO0034765', 'GO0043269', 'GO0071805', 'GO0007264', 'GO0008104', 'GO0015031', 'GO0035556', 'GO0045184', 'GO0010564', 'GO0043066', 'GO0043069', 'GO0045786', 'GO0051726', 'GO0060548', 'GO0005975', 'GO0030258', 'GO0070085', 'GO0006259', 'GO0006281', 'GO0006310', 'GO0006974', 'GO0033554', 'GO0006357', 'GO0009893', 'GO0010557', 'GO0010628', 'GO0031325', 'GO0031328', 'GO0045893', 'GO0045944', 'GO0034976', 'GO0001775', 'GO0007596', 'GO0007599', 'GO0009611', 'GO0030168', 'GO0042060', 'GO0050878', 'GO0016485', 'GO0043603', 'GO0044262', 'GO0006091', 'GO0006163', 'GO0009116', 'GO0009117', 'GO0009259', 'GO0015980', 'GO0019637', 'GO0042278', 'GO0045333', 'GO0055086', 'GO0016055', 'GO0006887', 'GO0032940', 'GO0046903', 'GO0006366', 'GO0009725', 'GO0014070', 'GO0030522', 'GO0032870', 'GO0033993', 'GO0048545', 'GO0071396', 'GO0071407', 'GO0018108', 'GO0018193', 'GO0006511', 'GO0019941', 'GO0030163', 'GO0044257', 'GO0044265', 'GO0051603', 'GO0007018', 'GO0034613', 'GO0032259', 'GO0006886', 'GO0006816', 'GO0006413', 'GO0006417', 'GO0010608', 'GO0008284', 'GO0009966', 'GO0042127', 'GO0006869', 'GO0010876', 'GO0061024', 'GO0032318', 'GO0032319', 'GO0032320', 'GO0032321', 'GO0035023', 'GO0043085', 'GO0043087', 'GO0043547', 'GO0046578', 'GO0051056', 'GO0051345', 'GO1902531', 'GO0010942', 'GO0043065', 'GO0043068', 'GO0015992', 'GO0009165', 'GO0006631', 'GO0032787', 'GO0050804', 'GO0006260', 'GO0090305', 'GO0006955', 'GO0019882', 'GO0048002', 'GO0006352', 'GO0006952', 'GO0009605', 'GO0009615', 'GO0051707', 'GO0022604', 'GO0007606', 'GO0007608', 'GO0009593', 'GO0050906', 'GO0050907', 'GO0050911', 'GO0051606', 'GO0048871', 'GO0006486', 'GO0009100', 'GO0009101', 'GO0043413', 'GO0050801', 'GO0008285', 'GO0009266', 'GO0009628', 'GO0050678', 'GO0009968', 'GO0023057', 'GO0006954', 'GO0010256', 'GO0006644', 'GO0006650', 'GO0046486', 'GO0046488', 'GO0006605', 'GO0016482', 'GO0033365', 'GO0072594', 'GO0072657', 'GO0090150', 'GO0048193', 'GO0016337', 'GO0000902', 'GO0000904', 'GO0006935', 'GO0007409', 'GO0007411', 'GO0009653', 'GO0032990', 'GO0040011', 'GO0048667', 'GO0048812', 'GO0048858', 'GO0061564', 'GO0016042', 'GO0030029', 'GO0030036', 'GO0000003', 'GO0007059', 'GO0051321', 'GO0018205', 'GO0006457', 'GO0046395', 'GO0006909', 'GO0008544', 'GO0016477', 'GO0048870', 'GO0009890', 'GO0090287', 'GO1903507', 'GO0019221', 'GO0034097', 'GO0071345', 'GO0006396', 'GO0006397', 'GO0016071', 'GO0016570', 'GO0040007', 'GO0015698', 'GO0006913', 'GO0051169', 'GO0010975', 'GO0030334', 'GO0031344', 'GO0031589', 'GO0040012', 'GO0045664', 'GO0050767', 'GO0051270', 'GO0060284', 'GO2000145', 'GO0033043', 'GO0051493', 'GO0006873', 'GO0006875', 'GO0030003', 'GO0055065', 'GO0055082', 'GO0007015', 'GO0032535', 'GO0032956', 'GO0032970', 'GO0043254', 'GO0019216', 'GO0042325', 'GO0043549', 'GO0051174', 'GO0016567', 'GO0032446', 'GO0008015', 'GO0008217', 'GO0008610', 'GO0008380', 'GO0010638', 'GO0044089', 'GO0051495', 'GO0042692', 'GO0048646', 'GO0051146', 'GO0061061', 'GO0008202', 'GO0007507', 'GO0048513', 'GO0072358', 'GO0000278', 'GO0007067', 'GO0070925', 'GO1903047', 'GO0006915', 'GO0008219', 'GO0012501', 'GO0016265', 'GO0000375', 'GO0000398', 'GO0001932', 'GO0001934', 'GO0006521', 'GO0010565', 'GO0031401', 'GO0032270', 'GO0033674', 'GO0042327', 'GO0045859', 'GO0045860', 'GO0050730', 'GO0051247', 'GO0051347', 'GO0006643', 'GO0060271', 'GO0009967', 'GO0043122', 'GO0043123', 'GO0045088', 'GO0045089', 'GO1902533', 'GO0009582', 'GO0007417', 'GO0007420', 'GO0009887', 'GO0060322', 'GO2001234', 'GO2001236', 'GO0005996', 'GO0019318', 'GO0030155', 'GO0006367', 'GO0071103', 'GO0006898', 'GO0030031', 'GO0016050', 'GO0006790', 'GO0030855', 'GO0043588', 'GO0002520', 'GO0030097', 'GO0000122', 'GO0001525', 'GO0001568', 'GO0001701', 'GO0001944', 'GO0003006', 'GO0008283', 'GO0010629', 'GO0022414', 'GO0044702', 'GO0045787', 'GO0045892', 'GO0048514', 'GO0048568', 'GO0048608', 'GO0048732', 'GO0051302', 'GO0061458', 'GO0090068', 'GO0007389', 'GO0009952', 'GO0010720', 'GO0021537', 'GO0030900', 'GO0045666', 'GO0050769', 'GO0045087', 'GO0051051', 'GO0007276', 'GO0007283', 'GO0019953', 'GO0032504', 'GO0048232', 'GO0048609', 'GO0051301', 'GO0001501', 'GO0001654', 'GO0007423', 'GO0030198', 'GO0043062', 'GO0060348', 'GO0061448', 'GO0001558', 'GO0007346', 'GO0040008', 'GO0045926', 'GO0045930', 'GO1901987', 'GO1901990', 'GO0045765', 'GO1902532', 'GO0007281', 'GO0040029', 'GO0003012', 'GO0006936', 'GO0030278', 'GO0045596', 'GO0045927', 'GO0048562', 'GO0048598', 'GO0048638', 'GO0048705', 'GO0048863', 'GO0048864', 'GO0006399', 'GO0022407', 'GO0022409', 'GO0034112', 'GO0045785', 'GO0050863', 'GO0050865', 'GO0050867', 'GO0050870', 'GO0051249', 'GO0043583', 'GO0048839', 'GO0043010', 'GO0048729', 'GO0000165', 'GO0007565', 'GO0023014', 'GO0032147', 'GO0043405', 'GO0043406', 'GO0043408', 'GO0043410', 'GO0071902', 'GO0007610', 'GO0010721', 'GO0050768', 'GO0007265', 'GO0008654', 'GO0016032', 'GO0019058', 'GO0034109', 'GO0014706', 'GO0060537', 'GO0007178', 'GO0002237', 'GO0009617', 'GO0032496', 'GO0050792', 'GO0007548', 'GO0008406', 'GO0045137', 'GO0030111', 'GO0030178', 'GO0007568', 'GO0030335', 'GO0032880', 'GO0033157', 'GO0040017', 'GO0051222', 'GO0051223', 'GO0051272', 'GO0070201', 'GO2000147', 'GO0007005', 'GO0002431', 'GO0038093', 'GO0038094', 'GO0038096', 'GO0001817', 'GO0051090', 'GO0045165', 'GO0007517', 'GO0001666', 'GO0021953', 'GO0001818', 'GO0002683', 'GO0050727', 'GO0001933', 'GO0006469', 'GO0033673', 'GO0042326', 'GO0051348', 'GO0001503', 'GO0051924', 'GO2000021', 'GO0046474', 'GO0007626', 'GO0097190', 'GO0097193', 'GO0031346', 'GO0044770', 'GO0044772', 'GO0007267', 'GO0007268', 'GO0009314', 'GO0009416', 'GO0010243', 'GO0042742', 'GO0051046', 'GO0002250', 'GO0002443', 'GO0002460', 'GO0050900', 'GO0051259', 'GO0051260', 'GO0006959', 'GO0050795', 'GO0009991', 'GO0010035', 'GO0010038', 'GO0031667', 'GO0042063', 'GO0042493', 'GO0043270', 'GO0044708', 'GO0031668', 'GO0031669', 'GO0032868', 'GO0043434', 'GO0046777', 'GO0046822', 'GO0051224', 'GO1900180', 'GO1901652', 'GO0043523', 'GO1901214', 'GO0000075', 'GO0032872', 'GO0006575', 'GO0030323', 'GO0030324', 'GO0060541', 'GO0048589', 'GO0072376', 'GO0050708', 'GO0051048', 'GO0008543', 'GO0044344', 'GO0071774', 'GO0060828', 'GO0002521', 'GO0030099', 'GO0048872', 'GO0071559', 'GO0071560', 'GO0046883', 'GO0050796', 'GO0090276', 'GO0030203', 'GO0000082', 'GO0001655', 'GO0001763', 'GO0001822', 'GO0002009', 'GO0035239', 'GO0060562', 'GO0061138', 'GO0072001', 'GO0001819', 'GO0007159', 'GO0030098', 'GO0042110', 'GO0045321', 'GO0045637', 'GO0046649', 'GO0048511', 'GO0070486', 'GO0070489', 'GO0071375', 'GO0071417', 'GO0071593', 'GO1901653', 'GO0030336', 'GO0040013', 'GO0051271', 'GO2000146', 'GO0007611', 'GO0050890', 'GO0007093', 'GO0033044', 'GO0042176', 'GO0061136', 'GO0002064', 'GO0051091', 'GO0051640', 'GO0051656', 'GO0010498', 'GO0043161', 'GO0006874', 'GO0042391', 'GO0045216', 'GO0055074', 'GO0000302', 'GO0050714', 'GO0051047', 'GO0043281', 'GO2000116', 'GO0030100', 'GO0045732', 'GO0043241', 'GO0043624', 'GO0070372', 'GO0003007', 'GO0060173', 'GO0051480', 'GO0007162', 'GO0009612', 'GO0042594', 'GO2001235', 'GO0045862', 'GO0006401', 'GO0031396', 'GO0000209', 'GO0000956', 'GO0006402', 'GO0043627', 'GO0009405', 'GO0016064', 'GO0019724', 'GO0051098', 'GO0007173', 'GO0038095', 'GO0038127', 'GO0038179', 'GO0048011', 'GO0032869', 'GO0060485', 'GO0043687']
bp_paths = path_dict['biological_process']

cc_go_terms = ['GO0016020', 'GO0016021', 'GO0031224', 'GO0005768', 'GO0005769', 'GO0005886', 'GO0010008', 'GO0012505', 'GO0016023', 'GO0030139', 'GO0031090', 'GO0031410', 'GO0031982', 'GO0031988', 'GO0048471', 'GO0071944', 'GO0098588', 'GO0005764', 'GO0005773', 'GO0043229', 'GO0043231', 'GO0005634', 'GO0005840', 'GO0030529', 'GO0032991', 'GO0005856', 'GO0005874', 'GO0015630', 'GO0043234', 'GO0005737', 'GO0005576', 'GO0005911', 'GO0030054', 'GO0015629', 'GO0005813', 'GO0005815', 'GO0031012', 'GO0000793', 'GO0005694', 'GO0005929', 'GO0042995', 'GO0005615', 'GO0005783', 'GO0005789', 'GO0042175', 'GO1990234', 'GO0005739', 'GO0005740', 'GO0031966', 'GO0005743', 'GO0019866', 'GO0034702', 'GO0034703', 'GO1902495', 'GO0000139', 'GO0005794', 'GO0012506', 'GO0030133', 'GO0030135', 'GO0030659', 'GO0005887', 'GO0031226', 'GO0045202', 'GO0005875', 'GO0005819', 'GO0005654', 'GO0031981', 'GO0043235', 'GO0005667', 'GO0005912', 'GO0005882', 'GO0045111', 'GO0005635', 'GO0005829', 'GO0000228', 'GO0000785', 'GO0031301', 'GO0005924', 'GO0005925', 'GO0030055', 'GO0005578', 'GO0000151', 'GO0019898', 'GO0005681', 'GO0005938', 'GO0072372', 'GO0030424', 'GO0043005', 'GO0070062', 'GO0005774', 'GO0005730', 'GO0019867', 'GO0030425', 'GO0036477', 'GO0045211', 'GO0097060', 'GO0005770', 'GO0031252', 'GO0016323', 'GO0009986', 'GO0016324', 'GO0045177', 'GO0043025', 'GO0044297', 'GO0005759', 'GO0045121', 'GO0031965', 'GO0030141', 'GO0030016', 'GO0043292', 'GO0016604', 'GO0031253', 'GO0000790', 'GO0009897', 'GO0000775', 'GO0005765', 'GO0016607', 'GO0005788']
cc_paths = path_dict['cellular_component']

old_mf_terms = len(mf_go_terms)

for go_term in mf_go_terms:
    for path in mf_paths:
        if go_term in path:
            index = path.index(go_term)
            redundant_terms = path[:index]

            for term in redundant_terms:
                if term in mf_go_terms:
                    mf_go_terms.remove(term)

new_mf_terms = len(mf_go_terms)

print('%d -> %d' % (old_mf_terms, new_mf_terms))

old_cc_terms = len(cc_go_terms)
for go_term in cc_go_terms:
    for path in cc_paths:
        if go_term in path:
            index = path.index(go_term)
            redundant_terms = path[:index]

            for term in redundant_terms:
                if term in cc_go_terms:
                    cc_go_terms.remove(term)

new_cc_terms = len(cc_go_terms)

print('%d -> %d' % (old_cc_terms, new_cc_terms))

old_bp_terms = len(bp_go_terms)
for go_term in bp_go_terms:
    for path in bp_paths:
        if go_term in path:
            index = path.index(go_term)
            redundant_terms = path[:index]

            for term in redundant_terms:
                if term in bp_go_terms:
                    bp_go_terms.remove(term)

new_bp_terms = len(bp_go_terms)

print('%d -> %d' % (old_bp_terms, new_bp_terms))

reduced_go_terms = {'molecular_function': mf_go_terms,
                    'biological_process': bp_go_terms,
                    'cellular_component': cc_go_terms}

with open('reduced_go_terms.pkl', 'wb') as f:
    pickle.dump(reduced_go_terms, f)
